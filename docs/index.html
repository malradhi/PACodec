<!DOCTYPE html>
<html lang="eng">



  <head>
    <title>PACodec</title>
      <article>
        <header>
		

		
  
<p><br> 
</br></p>
	
	<h1>Prosody-Guided Harmonic Attention for Phase-Coherent Neural Vocoding in the Complex Spectrum</h1>
        </header>
      </article>
	  <p>  </p>
	  
	  <p><b>Authors:</b> <a href="https://malradhi.github.io/" target="_blank">Mohammed Salah Al-Radhi</a>, Riad Larbi, Mátyás Bartalis, Géza Németh</p>
	  <p> 
	  </p>  
<p> 
</p>





<p>
<b>Abstract: </b>
Neural vocoders are central to speech synthesis; despite
their success, most still suffer from limited prosody
modeling and inaccurate phase reconstruction. We propose a
vocoder that introduces prosody-guided harmonic attention
to enhance voiced-segment encoding and directly predicts
complex-spectral components for waveform synthesis via
inverse STFT. Unlike mel-spectrogram–based approaches,
our design jointly models magnitude and phase, ensuring
phase coherence and improved pitch fidelity. To further
align with perceptual quality, we adopt a multi-objective
training strategy that integrates adversarial, spectral, and
phase-aware losses. Experiments on benchmark datasets
demonstrate consistent gains over HiFi-GAN and
AutoVocoder: F0-RMSE reduced by 22%, voiced/unvoiced
error lowered by 18%, and MOS scores improved by 0.15.
These results show that prosody-guided attention combined
with direct complex-spectrum modeling yields more natural,
pitch-accurate, and robust synthetic speech, setting a strong
foundation for expressive neural vocoding.
</p>

<!-- <p align="left"><img width="40%" src="../img/model.jpg" /></p> -->

<p align="left">
  <img width="20%" src="https://raw.githubusercontent.com/malradhi/PACodec/main/img/model.jpg" alt="Model Architecture" />
</p>




<hr>




<br />



<h1 style="text-align:center;color:blue"; style="font-family:verdana;">1) Female Speaker </h1>

<!-- ========== Female Sample: LJ018-0213 ========== -->
<h3>Sample 1: LJ018-0213</h3>

<div>	
      <table class="table">
	<thead>
	  <tr>
	    <th>Natural</th>
	    <th>Anchor</th>
		<th>HiFi-GAN</th>
		<th>AutoVocoder</th>
		<th>Vocos</th>
		<th>Proposed</th>
	  </tr>
	</thead>
	<tbody>
	  <tr>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/01_Original/LJ018-0213.wav" type="audio/wav">
	      </audio>
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/02_Anchor/LJ018-0213.wav" type="audio/wav">
	      </audio>
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/03_HiFiGAN/LJ018-0213.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/04_AutoVocoder/LJ018-0213.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/05_Vocos/LJ018-0213.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/06_Proposed/LJ018-0213.wav" type="audio/wav">
	      </audio>
	    </td>		

	  </tr>
	</tbody>
      </table>
	</div>
	    
<!-- Put the exact spoken text here -->
</figure>
	<figcaption>Transcript: <em>which in dramatic interest can compare with the conviction of William Rupel for forgery.</em></figcaption>
</figure>	  

<br />	



<!-- ========== Female Sample: LJ027-0125 ========== -->
<h3>Sample 2: LJ027-0125</h3>
	
<div>	
      <table class="table">
	<thead>
	  <tr>
	    <th>Natural</th>
	    <th>Anchor</th>
		<th>HiFi-GAN</th>
		<th>AutoVocoder</th>
		<th>Vocos</th>
		<th>Proposed</th>
	  </tr>
	</thead>
	<tbody>
	  <tr>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/01_Original/LJ027-0125.wav" type="audio/wav">
	      </audio>	  
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/02_Anchor/LJ027-0125.wav" type="audio/wav">
	      </audio>
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/03_HiFiGAN/LJ027-0125.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/04_AutoVocoder/LJ027-0125.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/05_Vocos/LJ027-0125.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/06_Proposed/LJ027-0125.wav" type="audio/wav">
	      </audio>
	    </td>		

	  </tr>
	</tbody>
      </table>
	</div>
	    
<!-- Put the exact spoken text here -->
</figure>
	<figcaption>Transcript: <em>In the Python we find very tiny rudiments of the hind limbs. Now,</em></figcaption>
</figure>	
<br />	


<!-- ========== Female Sample: LJ003-0093 ========== -->
<h3>Sample 3: LJ003-0093</h3>

<div>	
      <table class="table">
	<thead>
	  <tr>
	    <th>Natural</th>
	    <th>Anchor</th>
		<th>HiFi-GAN</th>
		<th>AutoVocoder</th>
		<th>Vocos</th>
		<th>Proposed</th>
	  </tr>
	</thead>
	<tbody>
	  <tr>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/01_Original/LJ003-0093.wav" type="audio/wav">
	      </audio>	  
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/02_Anchor/LJ003-0093.wav" type="audio/wav">
	      </audio>
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/03_HiFiGAN/LJ003-0093.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/04_AutoVocoder/LJ003-0093.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/05_Vocos/LJ003-0093.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/06_Proposed/LJ003-0093.wav" type="audio/wav">
	      </audio>
	    </td>		

	  </tr>
	</tbody>
      </table>
	</div>
	    
<!-- Put the exact spoken text here -->
</figure>
	<figcaption>Transcript: <em>The oldest only 12 or 13, exposed to all the contaminating influences of the place.</em></figcaption>
</figure>	
<br />	

<!-- ========== Female Sample: LJ010-0110 ========== -->
<h3>Sample 4: LJ010-0110</h3>

<div>	
      <table class="table">
	<thead>
	  <tr>
	    <th>Natural</th>
	    <th>Anchor</th>
		<th>HiFi-GAN</th>
		<th>AutoVocoder</th>
		<th>Vocos</th>
		<th>Proposed</th>
	  </tr>
	</thead>
	<tbody>
	  <tr>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/01_Original/LJ010-0110.wav" type="audio/wav">
	      </audio>	  
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/02_Anchor/LJ010-0110.wav" type="audio/wav">
	      </audio>
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/03_HiFiGAN/LJ010-0110.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/04_AutoVocoder/LJ010-0110.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/05_Vocos/LJ010-0110.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/06_Proposed/LJ010-0110.wav" type="audio/wav">
	      </audio>
	    </td>		

	  </tr>
	</tbody>
      </table>
	</div>
	    
<!-- Put the exact spoken text here -->
</figure>
	<figcaption>Transcript: <em>Several of the other prisoners took the same line as regards Edward's</em></figcaption>
</figure>	
<br />	







<br />



<h1 style="text-align:center;color:blue"; style="font-family:verdana;">2) Male Speaker </h1>


<!-- ========== Female Sample: p226_028 ========== -->
<h3>Sample 1: p226_028</h3>

<div>	
      <table class="table">
	<thead>
	  <tr>
	    <th>Natural</th>
	    <th>Anchor</th>
		<th>HiFi-GAN</th>
		<th>AutoVocoder</th>
		<th>Vocos</th>
		<th>Proposed</th>
	  </tr>
	</thead>
	<tbody>
	  <tr>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/01_Original/p226_028.wav" type="audio/wav">
	      </audio>
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/02_Anchor/p226_028.wav" type="audio/wav">
	      </audio>
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/03_HiFiGAN/p226_028.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/04_AutoVocoder/p226_028.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/05_Vocos/p226_028.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/06_Proposed/p226_028.wav" type="audio/wav">
	      </audio>
	    </td>		

	  </tr>
	</tbody>
      </table>
	</div>
	    
<!-- Put the exact spoken text here -->
</figure>
	<figcaption>Transcript: <em>Suggestions of the action being a punishment were dismissed.</em></figcaption>
</figure>	  

<br />	

<!-- ========== Female Sample: p226_157 ========== -->
<h3>Sample 2: p226_157</h3>
	
<div>	
      <table class="table">
	<thead>
	  <tr>
	    <th>Natural</th>
	    <th>Anchor</th>
		<th>HiFi-GAN</th>
		<th>AutoVocoder</th>
		<th>Vocos</th>
		<th>Proposed</th>
	  </tr>
	</thead>
	<tbody>
	  <tr>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/01_Original/p226_157.wav" type="audio/wav">
	      </audio>	  
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/02_Anchor/p226_157.wav" type="audio/wav">
	      </audio>
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/03_HiFiGAN/p226_157.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/04_AutoVocoder/p226_157.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/05_Vocos/p226_157.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/06_Proposed/LJ027-0125.wav" type="audio/wav">
	      </audio>
	    </td>		

	  </tr>
	</tbody>
      </table>
	</div>
	    
<!-- Put the exact spoken text here -->
</figure>
	<figcaption>Transcript: <em>Elaine Baxter did not have long to speak on Friday.</em></figcaption>
</figure>	
<br />	


<!-- ========== Female Sample: p226_299 ========== -->
<h3>Sample 3: p226_299</h3>

<div>	
      <table class="table">
	<thead>
	  <tr>
	    <th>Natural</th>
	    <th>Anchor</th>
		<th>HiFi-GAN</th>
		<th>AutoVocoder</th>
		<th>Vocos</th>
		<th>Proposed</th>
	  </tr>
	</thead>
	<tbody>
	  <tr>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/01_Original/p226_299.wav" type="audio/wav">
	      </audio>	  
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/02_Anchor/p226_299.wav" type="audio/wav">
	      </audio>
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/03_HiFiGAN/p226_299.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/04_AutoVocoder/p226_299.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/05_Vocos/p226_299.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/06_Proposed/p226_299.wav" type="audio/wav">
	      </audio>
	    </td>		

	  </tr>
	</tbody>
      </table>
	</div>
	    
<!-- Put the exact spoken text here -->
</figure>
	<figcaption>Transcript: <em>There was no hint of scandal.</em></figcaption>
</figure>	
<br />	

<!-- ========== Female Sample: p226_068 ========== -->
<h3>Sample 4: p226_068</h3>


<div>	
      <table class="table">
	<thead>
	  <tr>
	    <th>Natural</th>
	    <th>Anchor</th>
		<th>HiFi-GAN</th>
		<th>AutoVocoder</th>
		<th>Vocos</th>
		<th>Proposed</th>
	  </tr>
	</thead>
	<tbody>
	  <tr>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/01_Original/p226_068.wav" type="audio/wav">
	      </audio>	  
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/02_Anchor/p226_068.wav" type="audio/wav">
	      </audio>
	    </td>
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/03_HiFiGAN/p226_068.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/04_AutoVocoder/p226_068.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/05_Vocos/p226_068.wav" type="audio/wav">
	      </audio>
	    </td>		
	    <td>
	      <audio controls="">
		<source src="https://raw.githubusercontent.com/malradhi/PACodec/main/samples/06_Proposed/p226_068.wav" type="audio/wav">
	      </audio>
	    </td>		

	  </tr>
	</tbody>
      </table>
	</div>
	    
<!-- Put the exact spoken text here -->
</figure>
	<figcaption>Transcript: <em>Scotland has great assets.</em></figcaption>
</figure>	
<br />	




	
	



<hr>
<h2 style="text-align:center;">Analysis Figures</h2>

<!-- Row 1: Fig 1 + Fig 2 -->
<table border="0" cellpadding="8" cellspacing="0" width="100%">
  <tr>
    <!-- Figure 1 -->
    <td valign="top" width="50%">
      <figure>
        <img
          src="https://raw.githubusercontent.com/malradhi/PACodec/main/img/f0_error_histograms.png"
          alt="F0 Error Distribution (Model − Original) on Voiced Frames"
          width="100%">
        <figcaption>
          <strong>Figure 1.</strong>
          <em>F0 error distribution between model outputs and the original signal on voiced frames.
          The Proposed model achieves the tightest clustering near zero error, indicating superior
          pitch tracking compared to HiFi-GAN, AutoVocoder, and Vocos.</em>
        </figcaption>
      </figure>
    </td>

    <!-- Figure 2 -->
    <td valign="top" width="50%">
      <figure>
        <img
          src="https://raw.githubusercontent.com/malradhi/PACodec/main/img/mel_f0_inset_comparison_horizontal.png"
          alt="Mel-Spectrogram with F0 (Original vs. HiFi-GAN, AutoVocoder, Vocos, Proposed) with Insets"
          width="100%">
        <figcaption>
          <strong>Figure 2.</strong>
          <em>Mel-spectrograms with F0 overlays. HiFi-GAN produces smoother but weaker harmonics,
          AutoVocoder retains harmonics with noticeable smearing, and Vocos yields fuzzy, unstable
          structures. The Proposed method best preserves harmonic sharpness and F0 alignment, closely
          resembling the original.</em>
        </figcaption>
      </figure>
    </td>
  </tr>
</table>

<!-- Row 2: Fig 3 + Fig 4 -->
<table border="0" cellpadding="8" cellspacing="0" width="100%">
  <tr>
    <!-- Figure 3 -->
    <td valign="top" width="50%">
      <figure>
        <img
          src="https://raw.githubusercontent.com/malradhi/PACodec/main/img/mel_zoom_f0_comparison.png"
          alt="Zoomed Mel+F0 comparison (Original, HiFi-GAN, AutoVocoder, Vocos, Proposed)"
          width="100%">
        <figcaption>
          <strong>Figure 3.</strong>
          <em>Zoomed-in Mel+F0 segment. The Proposed model maintains sharp, well-aligned harmonics,
          while AutoVocoder produces smeared bands, HiFi-GAN shows smoother but drifting pitch,
          and Vocos displays unstable harmonics.</em>
        </figcaption>
      </figure>
    </td>

    <!-- Figure 4 -->
    <td valign="top" width="50%">
      <figure>
        <img
          src="https://raw.githubusercontent.com/malradhi/PACodec/main/img/residual_mel_energy_over_time.png"
          alt="Residual Mel Energy vs Original (per frame) over Time"
          width="100%">
        <figcaption>
          <strong>Figure 4.</strong>
          <em>Residual mel energy (L2 difference) over time compared to the original.
          The Proposed model and HiFi-GAN maintain consistently low residuals, while
          AutoVocoder exhibits large error spikes and Vocos shows higher variability.</em>
        </figcaption>
      </figure>
    </td>
  </tr>
</table>

























<!-- 
<p align="left">
  <img width="40%" src="https://raw.githubusercontent.com/malradhi/MiSTR/main/img/compare.png" alt="Model Architecture" />
</p>

 -->










<hr>
	
  </head>
</html>
